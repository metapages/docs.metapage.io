"use strict";(self.webpackChunkmetapage_docs=self.webpackChunkmetapage_docs||[]).push([[1330],{18181:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"Containers/container-cli-reference","title":"worker cli reference","description":"199018579bb580eabec7f8348c474287}","source":"@site/docs/Containers/container-cli-reference.mdx","sourceDirName":"Containers","slug":"/container-cli-reference","permalink":"/docs/container-cli-reference","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"worker cli reference","sidebar_position":3,"slug":"/container-cli-reference"},"sidebar":"tutorialSidebar","previous":{"title":"local","permalink":"/docs/container-local-mode"},"next":{"title":"github refs in URLs","permalink":"/docs/git-refs-in-urls"}}');var s=n(74848),c=n(28453);const o={title:"worker cli reference",sidebar_position:3,slug:"/container-cli-reference"},i="Command line reference for the worker agent {#199018579bb580eabec7f8348c474287}",a={},l=[];function d(e){const r={a:"a",code:"code",h1:"h1",header:"header",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"199018579bb580eabec7f8348c474287",children:"Command line reference for the worker agent"})}),"\n",(0,s.jsx)(r.p,{children:"Example of the command to run a worker agent to process your container jobs:"}),"\n",(0,s.jsxs)(r.p,{children:["(But see ",(0,s.jsx)(r.a,{href:"https://metapage.io/settings/queues",children:"https://metapage.io/settings/queues"})," for the most up-to-date version)"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n\t-v /tmp:/tmp metapage/metaframe-docker-worker:0.54.4 \\\n\trun --data-directory /tmp/worker-metapage-io-remote \\\n\t--cpus=2 --gpus=1 --mode=remote my-queue\n"})}),"\n",(0,s.jsx)(r.h1,{id:"199018579bb580c8a23cea38b29e5b58",children:"Env vars"}),"\n",(0,s.jsx)(r.p,{children:"These are the environment variables that can be used instead of cli arguments, also some advanced options are only available via env vars:"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Env var"}),(0,s.jsx)(r.th,{children:"cli command example"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_CPUS"}),(0,s.jsx)(r.td,{children:"\u2014cpus 1"}),(0,s.jsx)(r.td,{children:"The max number CPU cores the worker will claim for jobs"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_GPUS"}),(0,s.jsx)(r.td,{children:"\u2014gpus 1"}),(0,s.jsx)(r.td,{children:"The max number GPUs the worker will claim for jobs"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_MODE"}),(0,s.jsxs)(r.td,{children:["\u2014mode ",(0,s.jsx)(r.code,{children:"local"})]}),(0,s.jsxs)(r.td,{children:["Default: ",(0,s.jsx)(r.code,{children:"remote"}),". ",(0,s.jsx)(r.code,{children:"remote"})," mode means the queue is in the cloud. ",(0,s.jsx)(r.code,{children:"local"})," means all compute runs on the local machine, no scaling possible, but does not require any external API."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_QUEUE"}),(0,s.jsx)(r.td,{}),(0,s.jsx)(r.td,{children:"The queue the worker connects to for jobs to complete"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_PORT"}),(0,s.jsx)(r.td,{children:"\u2014port 8000"}),(0,s.jsxs)(r.td,{children:["Default: 8000. When in ",(0,s.jsx)(r.code,{children:"--mode local"}),", this is the port the worker uses to connect."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_API_ADDRESS"}),(0,s.jsxs)(r.td,{children:["\u2014api-address ",(0,s.jsx)(r.a,{href:"https://container.mtfm.io",children:"https://container.mtfm.io"})]}),(0,s.jsx)(r.td,{children:"Advanced or development use only. Allows connecting the worker to a different API queue server"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_GENERATE_WORKER_ID"}),(0,s.jsx)(r.td,{}),(0,s.jsxs)(r.td,{children:["If set to ",(0,s.jsx)(r.code,{children:"true"})," then the worker will always generate a new unique id on every start."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"METAPAGE_IO_WORKER_RUN_STANDALONE"}),(0,s.jsx)(r.td,{}),(0,s.jsx)(r.td,{children:"If set to true, will start a docker daemon process as a subprocess."})]})]})]}),"\n",(0,s.jsx)(r.mermaid,{value:'graph LR\n  containers["Metaframe: Containers"]\n  local["Local mode"]\n  remote["Remote mode"]\n  gitrefs["git refs in URLs"]\n  cli["cli reference"]\n  urlparams["URL parameters"]\n\n  containers --\x3e remote  \n  containers --\x3e local\n  containers --\x3e gitrefs\n  remote --\x3e cli\n  local --\x3e cli\n  urlparams --\x3e gitrefs\n  click containers "/docs/containers"\n  click remote "/docs/container-remote-mode"\n  click local "/docs/container-local-mode"\n  click gitrefs "/docs/git-refs-in-urls"\n  click cli "/docs/container-cli-reference"\n  style cli fill:#fff,stroke:#999999,stroke-width:2px,color:#000\n  click urlparams "/docs/inject-url-parameters"'})]})}function h(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>i});var t=n(96540);const s={},c=t.createContext(s);function o(e){const r=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(c.Provider,{value:r},e.children)}}}]);