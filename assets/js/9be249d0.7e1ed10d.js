"use strict";(self.webpackChunkmetapage_docs=self.webpackChunkmetapage_docs||[]).push([[1614],{28453:(e,r,s)=>{s.d(r,{R:()=>i,x:()=>c});var a=s(96540);const n={},t=a.createContext(n);function i(e){const r=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(t.Provider,{value:r},e.children)}},44445:(e,r,s)=>{s.d(r,{A:()=>a});const a=s.p+"assets/images/inject-url-parameters.19e01857-9bb5-80d9-9f77-c8654a79cab7-30b6703c79eb2286978511f7e6611db4.png"},65471:(e,r,s)=>{s.d(r,{A:()=>a});const a=s.p+"assets/images/inject-url-parameters.19e01857-9bb5-80ee-8882-d91a1b0c4e2f-cf578fd541d2903a7508a35389f76b9a.png"},87018:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"Concepts/inject-url-parameters","title":"Inject URL parameters","description":"19e018579bb580818e18d97e5872e942}","source":"@site/docs/Concepts/inject-url-parameters.mdx","sourceDirName":"Concepts","slug":"/inject-url-parameters","permalink":"/docs/inject-url-parameters","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Inject URL parameters","sidebar_position":10,"slug":"/inject-url-parameters"},"sidebar":"tutorialSidebar","previous":{"title":"URL structure","permalink":"/docs/url-structure"},"next":{"title":"Websocket streaming","permalink":"/docs/websocket-streaming"}}');var n=s(74848),t=s(28453);const i={title:"Inject URL parameters",sidebar_position:10,slug:"/inject-url-parameters"},c="Inject URL paramaters: turn a metapage into a configureable view {#19e018579bb580818e18d97e5872e942}",o={},d=[{value:"Overview",id:"da7caceb26ff4fbb8ef04017f4820193",level:2},{value:"Javascript",id:"19e018579bb58057a444e36a6b125073",level:2},{value:"Containers",id:"19e018579bb580b1af25c0c39b2974f3",level:2}];function l(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"19e018579bb580818e18d97e5872e942",children:"Inject URL paramaters: turn a metapage into a configureable view"})}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"URLS: browser"}),"\xa0",(0,n.jsx)(r.strong,{children:(0,n.jsx)(r.code,{children:"?key=xyz"})}),"\xa0",(0,n.jsx)(r.strong,{children:"with frame"}),"\xa0",(0,n.jsx)(r.strong,{children:(0,n.jsx)(r.code,{children:"?foo=_key_"})})," ",(0,n.jsx)(r.strong,{children:"becomes frame"})," ",(0,n.jsx)(r.strong,{children:(0,n.jsx)(r.code,{children:"?foo=xzy"})})]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Main example: ",(0,n.jsx)(r.a,{href:"https://metapage.io/m/40e42e0e53224cf99c0d20fa1323c043?key=abc",children:"URL parameters injected into component search or hash parameters"})]}),"\n",(0,n.jsxs)(r.li,{children:["Second example: ",(0,n.jsx)(r.a,{href:"https://metapage.io/m/e03d2cd291fb4e8da979d13f82a3abb0?key=value-from-the-url",children:"URL parameters injected into component frame paths"})]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"da7caceb26ff4fbb8ef04017f4820193",children:"Overview"}),"\n",(0,n.jsx)(r.p,{children:"URL parameters allow you to customize metapages by passing configuration values through the URL. This transforms static metapages into dynamically configurable views without modifying the underlying metapage."}),"\n",(0,n.jsxs)(r.p,{children:["In other words: a metapage becomes a function, or ",(0,n.jsx)(r.strong,{children:"resolver"}),","]}),"\n",(0,n.jsxs)(r.p,{children:["You can add URL search and hash parameters to the metapage url, and those parameters will be passed down to the metaframes that have ",(0,n.jsx)(r.code,{children:"_key_"})," as hash or query param. e.g."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:"https://metapage.io/m/40e42e0e53224cf99c0d20fa1323c043?key=abc\n"})}),"\n",(0,n.jsxs)(r.p,{children:["This passes ",(0,n.jsx)(r.code,{children:"key=abc"})," to the container metaframes."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:"https://some.frame/?foo=_key_\n"})}),"\n",(0,n.jsx)(r.p,{children:"becomes"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:"https://some.frame/?foo=abc\n"})}),"\n",(0,n.jsxs)(r.p,{children:["One of those builds a docker image from a git repository from a git tag: ",(0,n.jsx)(r.code,{children:"abc"})," :"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:"https://github.com/metapages/test-github-refs/tree/${key}\n"})}),"\n",(0,n.jsx)(r.p,{children:"Now the entire metapage is configured to point to a specific git tag or commit sha."}),"\n",(0,n.jsx)(r.h1,{id:"19e018579bb580069162c855b58bb769",children:"How to Use URL Parameters in Different Metaframes"}),"\n",(0,n.jsx)(r.h2,{id:"19e018579bb58057a444e36a6b125073",children:"Javascript"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.a,{href:"https://metapage.io/https://metapage.io/mf/tn2rlkhaiq#?tag=xyz",children:"Example metaframe"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"import { getHashParamFromWindow } from 'https://cdn.jsdelivr.net/npm/@metapages/hash-query@0.8.4/+esm'\n\nconst value = getHashParamFromWindow(\"key\")\nlog(`key=${value}`)\n"})}),"\n",(0,n.jsx)(r.p,{children:"The above code block shows how to access URL hash parameters that are injected from the main webpage."}),"\n",(0,n.jsx)(r.h2,{id:"19e018579bb580b1af25c0c39b2974f3",children:"Containers"}),"\n",(0,n.jsxs)(r.p,{children:["You can use this mechanism to ",(0,n.jsx)(r.a,{href:"/docs/git-refs-in-urls",children:"define the exact git repo the docker image is built from."})]}),"\n",(0,n.jsxs)(r.p,{children:["Any ",(0,n.jsx)(r.code,{children:"key=_value_"})," URL parameter is accessible by the container git repo URL and other places:"]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"The git URL"})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{src:s(65471).A+"",width:"1264",height:"384"})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"The docker command"})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{src:s(44445).A+"",width:"1266",height:"300"})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"The container env vars"})}),"\n",(0,n.jsxs)(r.p,{children:["All browser URL parameters are available to the container environment as environment variables, except the following, which are used internally by the container metaframe, and thus cannot be overridden: [ ",(0,n.jsx)(r.code,{children:"autostart"}),", ",(0,n.jsx)(r.code,{children:"control"}),", ",(0,n.jsx)(r.code,{children:"config"})," , ",(0,n.jsx)(r.code,{children:"debug"}),", ",(0,n.jsx)(r.code,{children:"definition"}),", ",(0,n.jsx)(r.code,{children:"inputs"}),", ",(0,n.jsx)(r.code,{children:"queueOverride"}),", ",(0,n.jsx)(r.code,{children:"ignoreQueueOverride"}),", ",(0,n.jsx)(r.code,{children:"job"}),", ",(0,n.jsx)(r.code,{children:"queue"}),"]"]}),"\n",(0,n.jsx)(r.admonition,{type:"tip",children:(0,n.jsxs)(r.p,{children:["User defined env vars is ",(0,n.jsx)(r.a,{href:"https://github.com/orgs/metapages/projects/1/views/1?pane=issue&itemId=98563477&issue=metapages%7Ccompute-queues%7C73",children:"on the roadmap"})]})}),"\n",(0,n.jsx)(r.h1,{id:"19e018579bb58086bed4f668eec15d32",children:"Related topics"}),"\n",(0,n.jsx)(r.mermaid,{value:'graph LR\n  gitrefs["git refs in URLs"]\n  urlparams["URL parameters"]\n\n  urlparams --\x3e gitrefs\n  click gitrefs "/docs/git-refs-in-urls"\n  click urlparams "/docs/inject-url-parameters"\n  style urlparams fill:#fff,stroke:#999999,stroke-width:2px,color:#000'})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}}}]);